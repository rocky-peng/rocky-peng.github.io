import{_ as o,$ as p,a0 as c,a1 as n,a3 as t,a4 as e,a5 as l,a2 as s,w as i}from"./framework-8c4427da.js";const u={},r=l(`<h2 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯" aria-hidden="true">#</a> ä½¿ç”¨åœºæ™¯</h2><p>ä¸€å¥è¯æ€»ç»“ï¼šä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ç»§ç»­æ‰§è¡Œã€‚</p><p>å…·ä½“åœºæ™¯ï¼š</p><ol><li>æŸä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚å°±å¥½æ¯”ä¸€ä¸ªå…¬äº¤è½¦ï¼Œå¸æœºå¸ˆå‚…éœ€è¦ç­‰åˆ°æ‰€æœ‰äººéƒ½ä¸Šè½¦åæ‰èƒ½å¯åŠ¨èµ·æ­¥ã€‚</li><li>å‘ä»¤æªï¼šå°±æ˜¯å¤šä¸ªçº¿ç¨‹ç­‰å¾…æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li><li>æ­»é”æ£€æµ‹ï¼šä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ n ä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºï¼Œåœ¨æ¯æ¬¡æµ‹è¯•é˜¶æ®µçš„çº¿ç¨‹æ•°ç›®æ˜¯ä¸åŒçš„ï¼Œå¹¶å°è¯•äº§ç”Ÿæ­»é”ã€‚ï¼ˆè¿™ä¸ªæ²¡æœ‰ç†è§£åˆ°ï¼‰</li></ol><h2 id="å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#å®ç°åŸç†" aria-hidden="true">#</a> å®ç°åŸç†</h2><p>åˆ†æä»£ç å‰ï¼Œå»ºè®®æˆ‘ä»¬æˆ‘ä»¬å…ˆè‡ªå·±æ ¹æ®å¯¹AQSçš„ç†è§£å’Œå¯¹CountDownLatchçš„ä½¿ç”¨åˆ›å»ºï¼Œ å…ˆå°è¯•çŒœæµ‹ä¸€ä¸‹å…¶å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>ä½ çš„çŒœæµ‹
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢å¼€å§‹æ­£å¼è®²CDLçš„ä»£ç å®ç°ã€‚ åŒæ ·çš„ï¼Œä¸ç”¨è´¨ç–‘CDLå†…éƒ¨è‚¯å®šä½¿ç”¨äº†AQSï¼ˆæ²¡çœ‹ä»£ç å‰è¿™ä¸€ç‚¹æ˜¯å¯ä»¥åˆ†æå¾—å‡ºçš„ï¼‰ æˆ‘ä»¬ç›´æ¥çœ‹CDLå†…éƒ¨æ˜¯å¦‚ä½•åˆ©ç”¨AQSçš„ã€‚</p><h3 id="syncç±»" tabindex="-1"><a class="header-anchor" href="#syncç±»" aria-hidden="true">#</a> Syncç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Sync</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractQueuedSynchronizer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">4982264981922014374L</span><span class="token punctuation">;</span>

    <span class="token class-name">Sync</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//1. åˆ©ç”¨çš„æ˜¯AQSçš„å…±äº«é”æ¨¡å¼</span>
    <span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">tryAcquireShared</span><span class="token punctuation">(</span><span class="token keyword">int</span> acquires<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">tryReleaseShared</span><span class="token punctuation">(</span><span class="token keyword">int</span> releases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Decrement count; signal when transition to zero</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> nextc <span class="token operator">=</span> c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compareAndSetState</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> nextc<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> nextc <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="countdownlatchç±»" tabindex="-1"><a class="header-anchor" href="#countdownlatchç±»" aria-hidden="true">#</a> CountDownLatchç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Sync</span> sync<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;count &lt; 0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sync</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    sync<span class="token punctuation">.</span><span class="token function">acquireSharedInterruptibly</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sync<span class="token punctuation">.</span><span class="token function">releaseShared</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h3><p>CDLåˆ©ç”¨çš„æ˜¯AQSçš„å…±äº«é”ï¼Œåœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šæŠŠstateè®¾ç½®ä¸ºcountçš„å€¼ã€‚ awaitæ–¹æ³•å°±æ˜¯è·å¾—å…±äº«é”ï¼Œä½†å¿…é¡»è¦ç­‰åˆ°stateçš„å€¼ä¸º0æ‰èƒ½æˆåŠŸè·å¾—å…±äº«é”ï¼Œå¦åˆ™è¿›å…¥åŒæ­¥é˜Ÿåˆ—ç­‰å¾… countDownæ–¹æ³•å°±æ˜¯åœ¨é‡Šæ”¾å…±äº«é”ï¼Œé‡Šæ”¾é€»è¾‘å°±æ˜¯å¯¹stateçš„å€¼å‡ä¸€ï¼Œç›´åˆ°stateçš„å€¼ä¸º0æ‰ä¼šæˆåŠŸé‡Šæ”¾</p><p>ä¸ªäººè®¤ä¸ºå®ç°éå¸¸å·§å¦™ï¼Œåœ¨çœ‹ä»£ç å‰æˆ‘æ¨æµ‹å‡ºäº†è‚¯å®šç”¨äº†AQSçš„å…±äº«é”ï¼ˆè¿™ç‚¹æ˜¯æ¨æµ‹æˆåŠŸäº†ï¼‰ï¼Œ ä½†åŒæ—¶æ€€ç–‘ä½¿ç”¨äº†AQSçš„æ¡ä»¶é˜Ÿåˆ—ï¼ˆè¿™ç‚¹å½“æ—¶æ¨æµ‹çš„æ—¶å€™ä¸ç¡®å®šï¼Œå› ä¸ºä¸è®°å¾—å…±äº«é”èƒ½ä¸èƒ½ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—äº†ï¼‰ï¼Œ åæ¥å›é¡¾äº†ä¸‹AQSçš„æ¡ä»¶é˜Ÿåˆ—ï¼Œå¾—çŸ¥<strong>åªæœ‰ç‹¬å é”æ‰èƒ½ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—</strong>ï¼Œäºæ˜¯åˆå¼€å§‹æ¨æµ‹CDLçš„å†…éƒ¨å®ç°ï¼Œå¯æƒœæ²¡èƒ½æƒ³å‡ºæ¥ğŸ˜‚</p><h2 id="æ‰©å±•" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•" aria-hidden="true">#</a> æ‰©å±•</h2><h3 id="countdownlatch-ç›¸å¸¸è§é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#countdownlatch-ç›¸å¸¸è§é¢è¯•é¢˜" aria-hidden="true">#</a> CountDownLatch ç›¸å¸¸è§é¢è¯•é¢˜ï¼š</h3><ol><li><p>è§£é‡Šä¸€ä¸‹ CountDownLatch æ¦‚å¿µï¼Ÿ</p></li><li><p>CountDownLatch å’Œ CyclicBarrier çš„ä¸åŒä¹‹å¤„ï¼Ÿ</p></li></ol><br><h2 id="ç³»ç»Ÿæ¨è" tabindex="-1"><a class="header-anchor" href="#ç³»ç»Ÿæ¨è" aria-hidden="true">#</a> ç³»ç»Ÿæ¨è</h2>`,20),d=n("p",null,[n("br"),n("br"),n("br"),n("br"),n("br"),n("br")],-1),k=n("hr",null,null,-1),v=n("hr",null,null,-1),h=n("ul",null,[n("li",null,[n("strong",null,"éšæœºæ¯’é¸¡æ±¤"),s("ï¼šä½ å¯ä»¥åœ¨æˆ‘é¢å‰ç‚«å¯Œï¼Œæ˜¯åœ¨æš—ç¤ºæˆ‘ï¼Œä»¥ååƒé¥­é’±ä½ ä»˜ã€‚ "),n("br"),n("br"),n("img",{src:"https://images.pexels.com/photos/16228208/pexels-photo-16228208.jpeg?auto=compress&cs=tinysrgb&h=650&w=940",alt:"Elderly men engaged in a game of chess against a traditional Beijing wall.",loading:"lazy"})])],-1);function m(b,w){const a=i("RouterLink");return p(),c("div",null,[r,n("ul",null,[n("li",null,[t(a,{to:"/other/%E6%9D%A5%E4%B8%AAJVM%E5%86%B7%E7%9F%A5%E8%AF%86.html"},{default:e(()=>[s("æ¥ä¸ªJVMå†·çŸ¥è¯†")]),_:1})]),n("li",null,[t(a,{to:"/other/Nacos-Spring%20Gateway-Spring%20boot%E6%97%A0%E6%84%9F%E5%8F%91%E5%B8%83.html"},{default:e(()=>[s("Nacos-Spring Gateway-Spring bootæ— æ„Ÿå‘å¸ƒ")]),_:1})]),n("li",null,[t(a,{to:"/other/Cornell%20Notes%20System.html"},{default:e(()=>[s("Cornell Notes System")]),_:1})]),n("li",null,[t(a,{to:"/software/java-basic/Thread%20&%20ExecutorService%20&%20ThreadPoolExecutor%20%E6%80%BB%E8%A7%88.html"},{default:e(()=>[s("Thread & ExecutorService & ThreadPoolExecutor æ€»è§ˆ")]),_:1})]),n("li",null,[t(a,{to:"/other/PGSQL%20GIN%E7%B4%A2%E5%BC%95%E2%80%9C%E5%A4%B1%E6%95%88%E2%80%9D.html"},{default:e(()=>[s("PGSQL GINç´¢å¼•â€œå¤±æ•ˆâ€")]),_:1})]),n("li",null,[t(a,{to:"/other/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E6%8B%BC%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%90%97%EF%BC%9F.html"},{default:e(()=>[s("ä½ çœŸçš„ä¼šæ‹¼æ¥å­—ç¬¦ä¸²å—ï¼Ÿ")]),_:1})]),n("li",null,[t(a,{to:"/software/unclassified/%E5%A4%9A%E5%8F%B0centos%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E6%96%87%E4%BB%B6%E4%BA%92%E7%9B%B8%E5%A4%87%E4%BB%BD.html"},{default:e(()=>[s("å¤šå°centosæœåŠ¡å™¨ï¼Œæ–‡ä»¶äº’ç›¸å¤‡ä»½")]),_:1})]),n("li",null,[t(a,{to:"/software/unclassified/%E5%88%B6%E4%BD%9CKVM%20ES%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6.html"},{default:e(()=>[s("åˆ¶ä½œKVM ESé•œåƒæ–‡ä»¶")]),_:1})]),n("li",null,[t(a,{to:"/software/middleware/mysql/MySQL%E4%B8%89%E5%A4%A7%E6%97%A5%E5%BF%97.html"},{default:e(()=>[s("MySQLä¸‰å¤§æ—¥å¿—")]),_:1})]),n("li",null,[t(a,{to:"/other/PGSQL%E7%9A%84json%E5%92%8C%20jsonb%20%E8%AF%BB%E5%86%99%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html"},{default:e(()=>[s("PGSQLçš„jsonå’Œ jsonb è¯»å†™æ€§èƒ½æµ‹è¯•")]),_:1})]),n("li",null,[t(a,{to:"/software/java-basic/Java%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80.html"},{default:e(()=>[s("Javaé¢è¯•åŸºç¡€")]),_:1})]),n("li",null,[t(a,{to:"/software/linux/Linux.html"},{default:e(()=>[s("Linux")]),_:1})])]),d,k,v,h])}const y=o(u,[["render",m],["__file","CountDownLatchæºç è§£è¯».html.vue"]]);export{y as default};
