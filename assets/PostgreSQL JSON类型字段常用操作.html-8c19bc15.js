import{_ as n,$ as a,a0 as s,a3 as e}from"./framework-28382e28.js";const t={},o=e(`<h2 id="初始数据" tabindex="-1"><a class="header-anchor" href="#初始数据" aria-hidden="true">#</a> 初始数据</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:1,&quot;name&quot;:&quot;小明&quot;, &quot;age&quot;:18}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:2,&quot;name&quot;:&quot;小明1&quot;, &quot;age&quot;:17}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:3,&quot;name&quot;:&quot;小明3&quot;, &quot;age&quot;:16}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:4,&quot;name&quot;:&quot;小明4&quot;, &quot;age&quot;:20}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:5,&quot;name&quot;:&quot;小明5&quot;, &quot;age&quot;:30}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:6,&quot;name&quot;:&quot;小明6&quot;, &quot;age&quot;:10}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:7,&quot;name&quot;:&quot;小明7&quot;, &quot;age&quot;:15}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:8,&quot;name&quot;:&quot;小明8&quot;, &quot;age&quot;:35}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> name_age <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#39;{&quot;id&quot;:9,&quot;name&quot;:&quot;小明9&quot;, &quot;age&quot;:35}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-4a3de158e20935f6b916a26b4cb21a54.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h2 id="where" tabindex="-1"><a class="header-anchor" href="#where" aria-hidden="true">#</a> Where</h2><h3 id="精确匹配" tabindex="-1"><a class="header-anchor" href="#精确匹配" aria-hidden="true">#</a> 精确匹配</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> info<span class="token operator">||</span><span class="token string">&#39;{&quot;gender&quot;:&quot;男&quot;}&#39;</span> <span class="token keyword">as</span> a<span class="token punctuation">,</span>info<span class="token operator">||</span><span class="token string">&#39;{&quot;gender&quot;:&quot;男&quot;}&#39;</span>::jsonb <span class="token keyword">as</span> b<span class="token punctuation">,</span>info <span class="token keyword">as</span> c <span class="token keyword">from</span> name_age <span class="token keyword">where</span> <span class="token punctuation">(</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span>::int4 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-62bd7ca712b92f604a125071fc48cc45.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><hr><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> info<span class="token operator">||</span><span class="token string">&#39;{&quot;gender&quot;:&quot;男&quot;}&#39;</span> <span class="token keyword">as</span> a<span class="token punctuation">,</span>info<span class="token operator">||</span><span class="token string">&#39;{&quot;gender&quot;:&quot;男&quot;}&#39;</span>::jsonb <span class="token keyword">as</span> b<span class="token punctuation">,</span>info <span class="token keyword">as</span> c <span class="token keyword">from</span> name_age <span class="token keyword">where</span> <span class="token punctuation">(</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&#39;小明4&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-1d441b9a2eed822cfcffa387ad17b785.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h3 id="模糊匹配" tabindex="-1"><a class="header-anchor" href="#模糊匹配" aria-hidden="true">#</a> 模糊匹配</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> name_age <span class="token keyword">where</span> info <span class="token comment">#&gt;&gt; &#39;{name}&#39; like &#39;%明&#39;;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-43f7e49091046edf383e859981ca1905.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><hr><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> name_age <span class="token keyword">where</span> <span class="token punctuation">(</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span> <span class="token operator">like</span> <span class="token string">&#39;%4&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-9ddfccdf3034813fc20ba24b625ad568.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h2 id="排序" tabindex="-1"><a class="header-anchor" href="#排序" aria-hidden="true">#</a> 排序</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> name_age <span class="token keyword">order</span> <span class="token keyword">by</span> info<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&#39;age&#39;</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>info<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&#39;id&#39;</span> <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> name_age <span class="token keyword">order</span> <span class="token keyword">by</span> info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;age&#39;</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>info<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&#39;id&#39;</span> <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> name_age <span class="token keyword">order</span> <span class="token keyword">by</span> info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;age&#39;</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;id&#39;</span> <span class="token keyword">asc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-89475d6fb050cc73e3f97fc49bd03c69.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h2 id="修改" tabindex="-1"><a class="header-anchor" href="#修改" aria-hidden="true">#</a> 修改</h2><h3 id="增加json字段" tabindex="-1"><a class="header-anchor" href="#增加json字段" aria-hidden="true">#</a> 增加json字段</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> name_age <span class="token keyword">set</span> info <span class="token operator">=</span> info <span class="token operator">||</span> <span class="token string">&#39;{&quot;gender&quot;:&quot;男&quot;}&#39;</span>::jsonb  <span class="token keyword">where</span> <span class="token punctuation">(</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span>::int4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-6af15a340c5be493c9b8ece7d96b06e0.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><figure><img src="https://cdn.justdopay.com/notion/md5-8ea2a5fac6d6e8d5cc4fa3b925805fd6.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h3 id="删除json字段" tabindex="-1"><a class="header-anchor" href="#删除json字段" aria-hidden="true">#</a> 删除json字段</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> name_age <span class="token keyword">set</span> info <span class="token operator">=</span> info<span class="token operator">-</span><span class="token string">&#39;gender&#39;</span> <span class="token keyword">where</span>  <span class="token punctuation">(</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span>::int4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-dff3c28e3b29f2f79048230c54a6dbfe.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><figure><img src="https://cdn.justdopay.com/notion/md5-5454c1282a1bd4089a55c9442657e34a.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h3 id="修改json字段值" tabindex="-1"><a class="header-anchor" href="#修改json字段值" aria-hidden="true">#</a> 修改json字段值</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> name_age <span class="token keyword">set</span> info <span class="token operator">=</span> info <span class="token operator">||</span> <span class="token string">&#39;{&quot;age&quot;:16}&#39;</span>::jsonb  <span class="token keyword">where</span> <span class="token punctuation">(</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span>::int4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.justdopay.com/notion/md5-e1f926e68951b3a665e46f972a174adc.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><figure><img src="https://cdn.justdopay.com/notion/md5-084eaf5e07602158aa1e5fa7f6943a6c.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h2 id="分页" tabindex="-1"><a class="header-anchor" href="#分页" aria-hidden="true">#</a> 分页</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> name_age <span class="token keyword">order</span> <span class="token keyword">by</span> info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;age&#39;</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>info<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">&#39;id&#39;</span> <span class="token keyword">asc</span>  <span class="token keyword">limit</span> <span class="token number">2</span> <span class="token keyword">offset</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>offset 从0开始</strong></li></ul><figure><img src="https://cdn.justdopay.com/notion/md5-af25be7103d393e043d2bfea53a1b981.png" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h2 id="其他内容" tabindex="-1"><a class="header-anchor" href="#其他内容" aria-hidden="true">#</a> 其他内容</h2><ol><li><p>统计表占用空间</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token constant">SELECT</span> table_schema <span class="token operator">||</span> <span class="token string">&#39;.&#39;</span> <span class="token operator">||</span> table_name                                         <span class="token constant">AS</span> table_full_name<span class="token punctuation">,</span>
       <span class="token function">pg_total_relation_size</span><span class="token punctuation">(</span><span class="token string">&#39;&quot;&#39;</span> <span class="token operator">||</span> table_schema <span class="token operator">||</span> <span class="token string">&#39;&quot;.&quot;&#39;</span> <span class="token operator">||</span> table_name <span class="token operator">||</span> <span class="token string">&#39;&quot;&#39;</span><span class="token punctuation">)</span> <span class="token constant">AS</span> size
<span class="token constant">FROM</span> information_schema<span class="token punctuation">.</span>tables
<span class="token constant">ORDER</span> <span class="token constant">BY</span> <span class="token function">pg_total_relation_size</span><span class="token punctuation">(</span><span class="token string">&#39;&quot;&#39;</span> <span class="token operator">||</span> table_schema <span class="token operator">||</span> <span class="token string">&#39;&quot;.&quot;&#39;</span> <span class="token operator">||</span> table_name <span class="token operator">||</span> <span class="token string">&#39;&quot;&#39;</span><span class="token punctuation">)</span> <span class="token constant">DESC</span> <span class="token constant">DESC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>筛选某个字段包含%的数据</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>select <span class="token operator">*</span> from xxxxx where aaa like <span class="token char">&#39;%\\%%&#39;</span> <span class="token constant">ESCAPE</span> &#39;\\&#39;<span class="token punctuation">;</span>

或者 

select <span class="token operator">*</span> from xxxxx where aaa like <span class="token char">&#39;%a%%&#39;</span> <span class="token constant">ESCAPE</span> <span class="token char">&#39;a&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p><br><br><br><br><br><br></p><hr><hr><ul><li><strong>随机毒鸡汤</strong>：我已经闲到，开始学习了…… <br><br><img src="https://tuapi.eees.cc/api.php?category=fengjing&amp;type=302&amp;uuid=966209c5-ffdc-474e-9996-7f3faa54e95c" alt="" loading="lazy"></li></ul>`,42),p=[o];function c(i,l){return a(),s("div",null,p)}const d=n(t,[["render",c],["__file","PostgreSQL JSON类型字段常用操作.html.vue"]]);export{d as default};
