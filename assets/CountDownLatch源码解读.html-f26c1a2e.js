import{_ as o,$ as p,a0 as c,a1 as n,a3 as t,a4 as e,a5 as l,a2 as s,w as i}from"./framework-349591b1.js";const u={},r=l(`<h2 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯" aria-hidden="true">#</a> ä½¿ç”¨åœºæ™¯</h2><p>ä¸€å¥è¯æ€»ç»“ï¼šä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ç»§ç»­æ‰§è¡Œã€‚</p><p>å…·ä½“åœºæ™¯ï¼š</p><ol><li>æŸä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚å°±å¥½æ¯”ä¸€ä¸ªå…¬äº¤è½¦ï¼Œå¸æœºå¸ˆå‚…éœ€è¦ç­‰åˆ°æ‰€æœ‰äººéƒ½ä¸Šè½¦åæ‰èƒ½å¯åŠ¨èµ·æ­¥ã€‚</li><li>å‘ä»¤æªï¼šå°±æ˜¯å¤šä¸ªçº¿ç¨‹ç­‰å¾…æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li><li>æ­»é”æ£€æµ‹ï¼šä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ n ä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºï¼Œåœ¨æ¯æ¬¡æµ‹è¯•é˜¶æ®µçš„çº¿ç¨‹æ•°ç›®æ˜¯ä¸åŒçš„ï¼Œå¹¶å°è¯•äº§ç”Ÿæ­»é”ã€‚ï¼ˆè¿™ä¸ªæ²¡æœ‰ç†è§£åˆ°ï¼‰</li></ol><h2 id="å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#å®ç°åŸç†" aria-hidden="true">#</a> å®ç°åŸç†</h2><p>åˆ†æä»£ç å‰ï¼Œå»ºè®®æˆ‘ä»¬æˆ‘ä»¬å…ˆè‡ªå·±æ ¹æ®å¯¹AQSçš„ç†è§£å’Œå¯¹CountDownLatchçš„ä½¿ç”¨åˆ›å»ºï¼Œ å…ˆå°è¯•çŒœæµ‹ä¸€ä¸‹å…¶å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>ä½ çš„çŒœæµ‹
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢å¼€å§‹æ­£å¼è®²CDLçš„ä»£ç å®ç°ã€‚ åŒæ ·çš„ï¼Œä¸ç”¨è´¨ç–‘CDLå†…éƒ¨è‚¯å®šä½¿ç”¨äº†AQSï¼ˆæ²¡çœ‹ä»£ç å‰è¿™ä¸€ç‚¹æ˜¯å¯ä»¥åˆ†æå¾—å‡ºçš„ï¼‰ æˆ‘ä»¬ç›´æ¥çœ‹CDLå†…éƒ¨æ˜¯å¦‚ä½•åˆ©ç”¨AQSçš„ã€‚</p><h3 id="syncç±»" tabindex="-1"><a class="header-anchor" href="#syncç±»" aria-hidden="true">#</a> Syncç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Sync</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractQueuedSynchronizer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">4982264981922014374L</span><span class="token punctuation">;</span>

    <span class="token class-name">Sync</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//1. åˆ©ç”¨çš„æ˜¯AQSçš„å…±äº«é”æ¨¡å¼</span>
    <span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">tryAcquireShared</span><span class="token punctuation">(</span><span class="token keyword">int</span> acquires<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">tryReleaseShared</span><span class="token punctuation">(</span><span class="token keyword">int</span> releases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Decrement count; signal when transition to zero</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> nextc <span class="token operator">=</span> c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compareAndSetState</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> nextc<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> nextc <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="countdownlatchç±»" tabindex="-1"><a class="header-anchor" href="#countdownlatchç±»" aria-hidden="true">#</a> CountDownLatchç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Sync</span> sync<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;count &lt; 0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sync</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    sync<span class="token punctuation">.</span><span class="token function">acquireSharedInterruptibly</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sync<span class="token punctuation">.</span><span class="token function">releaseShared</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h3><p>CDLåˆ©ç”¨çš„æ˜¯AQSçš„å…±äº«é”ï¼Œåœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šæŠŠstateè®¾ç½®ä¸ºcountçš„å€¼ã€‚ awaitæ–¹æ³•å°±æ˜¯è·å¾—å…±äº«é”ï¼Œä½†å¿…é¡»è¦ç­‰åˆ°stateçš„å€¼ä¸º0æ‰èƒ½æˆåŠŸè·å¾—å…±äº«é”ï¼Œå¦åˆ™è¿›å…¥åŒæ­¥é˜Ÿåˆ—ç­‰å¾… countDownæ–¹æ³•å°±æ˜¯åœ¨é‡Šæ”¾å…±äº«é”ï¼Œé‡Šæ”¾é€»è¾‘å°±æ˜¯å¯¹stateçš„å€¼å‡ä¸€ï¼Œç›´åˆ°stateçš„å€¼ä¸º0æ‰ä¼šæˆåŠŸé‡Šæ”¾</p><p>ä¸ªäººè®¤ä¸ºå®ç°éå¸¸å·§å¦™ï¼Œåœ¨çœ‹ä»£ç å‰æˆ‘æ¨æµ‹å‡ºäº†è‚¯å®šç”¨äº†AQSçš„å…±äº«é”ï¼ˆè¿™ç‚¹æ˜¯æ¨æµ‹æˆåŠŸäº†ï¼‰ï¼Œ ä½†åŒæ—¶æ€€ç–‘ä½¿ç”¨äº†AQSçš„æ¡ä»¶é˜Ÿåˆ—ï¼ˆè¿™ç‚¹å½“æ—¶æ¨æµ‹çš„æ—¶å€™ä¸ç¡®å®šï¼Œå› ä¸ºä¸è®°å¾—å…±äº«é”èƒ½ä¸èƒ½ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—äº†ï¼‰ï¼Œ åæ¥å›é¡¾äº†ä¸‹AQSçš„æ¡ä»¶é˜Ÿåˆ—ï¼Œå¾—çŸ¥<strong>åªæœ‰ç‹¬å é”æ‰èƒ½ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—</strong>ï¼Œäºæ˜¯åˆå¼€å§‹æ¨æµ‹CDLçš„å†…éƒ¨å®ç°ï¼Œå¯æƒœæ²¡èƒ½æƒ³å‡ºæ¥ğŸ˜‚</p><h2 id="æ‰©å±•" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•" aria-hidden="true">#</a> æ‰©å±•</h2><h3 id="countdownlatch-ç›¸å¸¸è§é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#countdownlatch-ç›¸å¸¸è§é¢è¯•é¢˜" aria-hidden="true">#</a> CountDownLatch ç›¸å¸¸è§é¢è¯•é¢˜ï¼š</h3><ol><li><p>è§£é‡Šä¸€ä¸‹ CountDownLatch æ¦‚å¿µï¼Ÿ</p></li><li><p>CountDownLatch å’Œ CyclicBarrier çš„ä¸åŒä¹‹å¤„ï¼Ÿ</p></li></ol><br><h2 id="ç³»ç»Ÿæ¨è" tabindex="-1"><a class="header-anchor" href="#ç³»ç»Ÿæ¨è" aria-hidden="true">#</a> ç³»ç»Ÿæ¨è</h2>`,20),d=n("p",null,[n("br"),n("br"),n("br"),n("br"),n("br"),n("br")],-1),k=n("hr",null,null,-1),v=n("hr",null,null,-1),h=n("ul",null,[n("li",null,[n("strong",null,"éšæœºæ¯’é¸¡æ±¤"),s("ï¼šåœ¨å­¤ç‹¬è¿™ä»¶äº‹ä¸Šï¼Œæˆ‘å¹¶ä¸å­¤ç‹¬ã€‚ "),n("br"),n("br"),n("img",{src:"https://images.pexels.com/photos/16228208/pexels-photo-16228208.jpeg?auto=compress&cs=tinysrgb&h=650&w=940",alt:"Elderly men engaged in a game of chess against a traditional Beijing wall.",loading:"lazy"})])],-1);function m(b,w){const a=i("RouterLink");return p(),c("div",null,[r,n("ul",null,[n("li",null,[t(a,{to:"/software/unclassified/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F.html"},{default:e(()=>[s("è®°ä¸€æ¬¡å†…å­˜æ³„æ¼")]),_:1})]),n("li",null,[t(a,{to:"/software/unclassified/MAT%E5%B7%A5%E5%85%B7.html"},{default:e(()=>[s("MATå·¥å…·")]),_:1})]),n("li",null,[t(a,{to:"/software/spring/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html"},{default:e(()=>[s("å¸¸è§é—®é¢˜")]),_:1})]),n("li",null,[t(a,{to:"/other/%E6%9D%A5%E4%B8%AAJVM%E5%86%B7%E7%9F%A5%E8%AF%86.html"},{default:e(()=>[s("æ¥ä¸ªJVMå†·çŸ¥è¯†")]),_:1})]),n("li",null,[t(a,{to:"/software/java-basic/%E5%BC%B1%E5%BC%95%E7%94%A8%E7%A4%BA%E4%BE%8B.html"},{default:e(()=>[s("å¼±å¼•ç”¨ç¤ºä¾‹")]),_:1})]),n("li",null,[t(a,{to:"/software/jvm/JDK%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7.html"},{default:e(()=>[s("JDKå‘½ä»¤è¡Œå·¥å…·")]),_:1})]),n("li",null,[t(a,{to:"/other/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85Google%20BBR.html"},{default:e(()=>[s("å¦‚ä½•å®‰è£…Google BBR")]),_:1})]),n("li",null,[t(a,{to:"/software/unclassified/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E7%AC%94%E8%AE%B0.html"},{default:e(()=>[s("ä¹±ä¸ƒå…«ç³Ÿçš„ç¬”è®°")]),_:1})]),n("li",null,[t(a,{to:"/software/shodowsocks/ShadowsockServerUpdatePort.html"},{default:e(()=>[s("ShadowsockServerUpdatePort")]),_:1})]),n("li",null,[t(a,{to:"/software/java-basic/AQS%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB.html"},{default:e(()=>[s("AQSæºç è§£è¯»")]),_:1})]),n("li",null,[t(a,{to:"/other/Java%E8%AF%AD%E8%A8%80%E5%AE%8C%E6%88%90notion%E7%AC%94%E8%AE%B0%E5%A4%87%E4%BB%BD.html"},{default:e(()=>[s("Javaè¯­è¨€å®Œæˆnotionç¬”è®°å¤‡ä»½")]),_:1})]),n("li",null,[t(a,{to:"/software/java-basic/Java%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80.html"},{default:e(()=>[s("Javaé¢è¯•åŸºç¡€")]),_:1})])]),d,k,v,h])}const f=o(u,[["render",m],["__file","CountDownLatchæºç è§£è¯».html.vue"]]);export{f as default};
