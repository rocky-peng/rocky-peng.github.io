import{_ as p,$ as o,a0 as c,a1 as n,a3 as t,a4 as e,a5 as l,a2 as s,w as i}from"./framework-58787b1c.js";const u={},r=l(`<h2 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯" aria-hidden="true">#</a> ä½¿ç”¨åœºæ™¯</h2><p>ä¸€å¥è¯æ€»ç»“ï¼šä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ç»§ç»­æ‰§è¡Œã€‚</p><p>å…·ä½“åœºæ™¯ï¼š</p><ol><li>æŸä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚å°±å¥½æ¯”ä¸€ä¸ªå…¬äº¤è½¦ï¼Œå¸æœºå¸ˆå‚…éœ€è¦ç­‰åˆ°æ‰€æœ‰äººéƒ½ä¸Šè½¦åæ‰èƒ½å¯åŠ¨èµ·æ­¥ã€‚</li><li>å‘ä»¤æªï¼šå°±æ˜¯å¤šä¸ªçº¿ç¨‹ç­‰å¾…æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li><li>æ­»é”æ£€æµ‹ï¼šä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ n ä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºï¼Œåœ¨æ¯æ¬¡æµ‹è¯•é˜¶æ®µçš„çº¿ç¨‹æ•°ç›®æ˜¯ä¸åŒçš„ï¼Œå¹¶å°è¯•äº§ç”Ÿæ­»é”ã€‚ï¼ˆè¿™ä¸ªæ²¡æœ‰ç†è§£åˆ°ï¼‰</li></ol><h2 id="å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#å®ç°åŸç†" aria-hidden="true">#</a> å®ç°åŸç†</h2><p>åˆ†æä»£ç å‰ï¼Œå»ºè®®æˆ‘ä»¬æˆ‘ä»¬å…ˆè‡ªå·±æ ¹æ®å¯¹AQSçš„ç†è§£å’Œå¯¹CountDownLatchçš„ä½¿ç”¨åˆ›å»ºï¼Œ å…ˆå°è¯•çŒœæµ‹ä¸€ä¸‹å…¶å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>ä½ çš„çŒœæµ‹
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢å¼€å§‹æ­£å¼è®²CDLçš„ä»£ç å®ç°ã€‚ åŒæ ·çš„ï¼Œä¸ç”¨è´¨ç–‘CDLå†…éƒ¨è‚¯å®šä½¿ç”¨äº†AQSï¼ˆæ²¡çœ‹ä»£ç å‰è¿™ä¸€ç‚¹æ˜¯å¯ä»¥åˆ†æå¾—å‡ºçš„ï¼‰ æˆ‘ä»¬ç›´æ¥çœ‹CDLå†…éƒ¨æ˜¯å¦‚ä½•åˆ©ç”¨AQSçš„ã€‚</p><h3 id="syncç±»" tabindex="-1"><a class="header-anchor" href="#syncç±»" aria-hidden="true">#</a> Syncç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Sync</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractQueuedSynchronizer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">4982264981922014374L</span><span class="token punctuation">;</span>

    <span class="token class-name">Sync</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//1. åˆ©ç”¨çš„æ˜¯AQSçš„å…±äº«é”æ¨¡å¼</span>
    <span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">tryAcquireShared</span><span class="token punctuation">(</span><span class="token keyword">int</span> acquires<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">tryReleaseShared</span><span class="token punctuation">(</span><span class="token keyword">int</span> releases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Decrement count; signal when transition to zero</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> nextc <span class="token operator">=</span> c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compareAndSetState</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> nextc<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> nextc <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="countdownlatchç±»" tabindex="-1"><a class="header-anchor" href="#countdownlatchç±»" aria-hidden="true">#</a> CountDownLatchç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Sync</span> sync<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;count &lt; 0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sync</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    sync<span class="token punctuation">.</span><span class="token function">acquireSharedInterruptibly</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sync<span class="token punctuation">.</span><span class="token function">releaseShared</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h3><p>CDLåˆ©ç”¨çš„æ˜¯AQSçš„å…±äº«é”ï¼Œåœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šæŠŠstateè®¾ç½®ä¸ºcountçš„å€¼ã€‚ awaitæ–¹æ³•å°±æ˜¯è·å¾—å…±äº«é”ï¼Œä½†å¿…é¡»è¦ç­‰åˆ°stateçš„å€¼ä¸º0æ‰èƒ½æˆåŠŸè·å¾—å…±äº«é”ï¼Œå¦åˆ™è¿›å…¥åŒæ­¥é˜Ÿåˆ—ç­‰å¾… countDownæ–¹æ³•å°±æ˜¯åœ¨é‡Šæ”¾å…±äº«é”ï¼Œé‡Šæ”¾é€»è¾‘å°±æ˜¯å¯¹stateçš„å€¼å‡ä¸€ï¼Œç›´åˆ°stateçš„å€¼ä¸º0æ‰ä¼šæˆåŠŸé‡Šæ”¾</p><p>ä¸ªäººè®¤ä¸ºå®ç°éå¸¸å·§å¦™ï¼Œåœ¨çœ‹ä»£ç å‰æˆ‘æ¨æµ‹å‡ºäº†è‚¯å®šç”¨äº†AQSçš„å…±äº«é”ï¼ˆè¿™ç‚¹æ˜¯æ¨æµ‹æˆåŠŸäº†ï¼‰ï¼Œ ä½†åŒæ—¶æ€€ç–‘ä½¿ç”¨äº†AQSçš„æ¡ä»¶é˜Ÿåˆ—ï¼ˆè¿™ç‚¹å½“æ—¶æ¨æµ‹çš„æ—¶å€™ä¸ç¡®å®šï¼Œå› ä¸ºä¸è®°å¾—å…±äº«é”èƒ½ä¸èƒ½ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—äº†ï¼‰ï¼Œ åæ¥å›é¡¾äº†ä¸‹AQSçš„æ¡ä»¶é˜Ÿåˆ—ï¼Œå¾—çŸ¥<strong>åªæœ‰ç‹¬å é”æ‰èƒ½ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—</strong>ï¼Œäºæ˜¯åˆå¼€å§‹æ¨æµ‹CDLçš„å†…éƒ¨å®ç°ï¼Œå¯æƒœæ²¡èƒ½æƒ³å‡ºæ¥ğŸ˜‚</p><h2 id="æ‰©å±•" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•" aria-hidden="true">#</a> æ‰©å±•</h2><h3 id="countdownlatch-ç›¸å¸¸è§é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#countdownlatch-ç›¸å¸¸è§é¢è¯•é¢˜" aria-hidden="true">#</a> CountDownLatch ç›¸å¸¸è§é¢è¯•é¢˜ï¼š</h3><ol><li><p>è§£é‡Šä¸€ä¸‹ CountDownLatch æ¦‚å¿µï¼Ÿ</p></li><li><p>CountDownLatch å’Œ CyclicBarrier çš„ä¸åŒä¹‹å¤„ï¼Ÿ</p></li></ol><br><h2 id="ç³»ç»Ÿæ¨è" tabindex="-1"><a class="header-anchor" href="#ç³»ç»Ÿæ¨è" aria-hidden="true">#</a> ç³»ç»Ÿæ¨è</h2>`,20),d=n("p",null,[n("br"),n("br"),n("br"),n("br"),n("br"),n("br")],-1),k=n("hr",null,null,-1),v=n("hr",null,null,-1),E=n("ul",null,[n("li",null,[n("strong",null,"éšæœºæ¯’é¸¡æ±¤"),s("ï¼šå¯¹äº80åçš„å¥½æ¶ˆæ¯ï¼Œä»–ä»¬90åè¿˜æœ‰10å¤šå¤©ï¼Œå°±30å²äº†ã€‚ "),n("br"),n("br"),n("img",{src:"https://tuapi.eees.cc/api.php?category=biying&type=302&uuid=20c149c1-7ac5-441a-8469-aceb647a1e2f",alt:"",loading:"lazy"})])],-1);function h(m,b){const a=i("RouterLink");return o(),c("div",null,[r,n("ul",null,[n("li",null,[t(a,{to:"/software/spring/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html"},{default:e(()=>[s("å¸¸è§é—®é¢˜")]),_:1})]),n("li",null,[t(a,{to:"/other/istio%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html"},{default:e(()=>[s("istioåŸºç¡€çŸ¥è¯†")]),_:1})]),n("li",null,[t(a,{to:"/software/unclassified/%E7%BA%BF%E4%B8%8AFullGC%E9%A2%91%E7%B9%81%E7%9A%84%E6%8E%92%E6%9F%A5.html"},{default:e(()=>[s("çº¿ä¸ŠFullGCé¢‘ç¹çš„æ’æŸ¥")]),_:1})]),n("li",null,[t(a,{to:"/software/middleware/mysql/InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E.html"},{default:e(()=>[s("InnoDBå­˜å‚¨å¼•æ“")]),_:1})]),n("li",null,[t(a,{to:"/other/JetBrains-License-Server.html"},{default:e(()=>[s("JetBrains-License-Server")]),_:1})]),n("li",null,[t(a,{to:"/other/PGSQL%E7%9A%84json%E5%92%8C%20jsonb%20%E8%AF%BB%E5%86%99%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html"},{default:e(()=>[s("PGSQLçš„jsonå’Œ jsonb è¯»å†™æ€§èƒ½æµ‹è¯•")]),_:1})]),n("li",null,[t(a,{to:"/other/vuepress/vuepress-theme-hope%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97.html"},{default:e(()=>[s("vuepress-theme-hopeä½¿ç”¨å¿ƒå¾—")]),_:1})]),n("li",null,[t(a,{to:"/other/Lombok%E7%9A%84Accessors%E5%AF%BC%E8%87%B4EasyExcel%E8%AF%BB%E5%8F%96%E5%A4%B1%E8%B4%A5.html"},{default:e(()=>[s("Lombokçš„Accessorså¯¼è‡´EasyExcelè¯»å–å¤±è´¥")]),_:1})]),n("li",null,[t(a,{to:"/other/Git%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E9%82%AE%E7%AE%B1.html"},{default:e(()=>[s("Gitå†å²è®°å½•ä¿®æ”¹ç”¨æˆ·åå’Œé‚®ç®±")]),_:1})]),n("li",null,[t(a,{to:"/other/%E5%85%8D%E8%B4%B9%20API%20%E6%AF%8F%E6%97%A5%E6%8F%90%E4%BE%9B%E6%91%B8%E9%B1%BC%E6%97%A5%E6%8A%A5%EF%BC%8C%E8%87%AA%E5%8A%A8%E8%BF%94%E5%9B%9E%E6%97%A0%E6%B0%B4%E5%8D%B0%E5%9B%BE%E7%89%87%EF%BC%8C%E9%80%82%E7%94%A8%E4%BA%8E%E5%85%AC%E4%BC%97%E5%8F%B7%E5%92%8C%E5%B0%8F%E7%A8%8B%E5%BA%8F.html"},{default:e(()=>[s("å…è´¹ API æ¯æ—¥æä¾›æ‘¸é±¼æ—¥æŠ¥ï¼Œè‡ªåŠ¨è¿”å›æ— æ°´å°å›¾ç‰‡ï¼Œé€‚ç”¨äºå…¬ä¼—å·å’Œå°ç¨‹åº")]),_:1})]),n("li",null,[t(a,{to:"/software/unclassified/%E5%88%86%E5%B8%83%E5%BC%8F%E9%97%AE%E9%A2%98.html"},{default:e(()=>[s("åˆ†å¸ƒå¼é—®é¢˜")]),_:1})]),n("li",null,[t(a,{to:"/software/middleware/es/ESRally%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E6%AD%A5%E9%AA%A4.html"},{default:e(()=>[s("ESRallyæ€§èƒ½æµ‹è¯•æ­¥éª¤")]),_:1})])]),d,k,v,E])}const A=p(u,[["render",h],["__file","CountDownLatchæºç è§£è¯».html.vue"]]);export{A as default};
