import{_ as i,$ as r,a0 as d,a1 as e,a3 as a,a4 as l,a5 as o,a2 as n,w as c}from"./framework-8c4427da.js";const t={},u=o(`<p>BBR 是google发布一个网络拥塞算法，相比其他算法而言其性能更高，能更好的利用网络带宽。</p><h2 id="前提条件" tabindex="-1"><a class="header-anchor" href="#前提条件" aria-hidden="true">#</a> 前提条件</h2><ul><li>CentOS 7.x</li><li>sudo 权限</li></ul><h2 id="步骤一-升级内核" tabindex="-1"><a class="header-anchor" href="#步骤一-升级内核" aria-hidden="true">#</a> 步骤一：升级内核</h2><ol><li><p>查看当前内核</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>uname -r
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>会有类似下面的输出</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token number">3.10</span>.<span class="token number">0</span><span class="token number">-514.2</span>.<span class="token number">2</span>.el7.x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>可以看到内核版本是3.10.0</p></li><li><p>安装 ELRepo</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>sudo rpm --import https<span class="token operator">:</span><span class="token comment">//www.elrepo.org/RPM-GPG-KEY-elrepo.org</span>

sudo rpm -Uvh http<span class="token operator">:</span><span class="token comment">//www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>安装高版本内核</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>sudo yum --enablerepo=elrepo-kernel install kernel-ml -y
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>安装完成后查看安装结果</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>rpm -qa | grep kernel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>如果安装成功，上面命令会输出 <code>kernel-ml-x.x.x-1.el7.elrepo.x86_64</code> ，类似下面样子</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>kernel-ml<span class="token number">-4.9</span>.<span class="token number">0</span><span class="token number">-1</span>.el7.elrepo.x86_64

kernel<span class="token number">-3.10</span>.<span class="token number">0</span><span class="token number">-514</span>.el7.x86_64

kernel-tools-libs<span class="token number">-3.10</span>.<span class="token number">0</span><span class="token number">-514.2</span>.<span class="token number">2</span>.el7.x86_64

kernel-tools<span class="token number">-3.10</span>.<span class="token number">0</span><span class="token number">-514.2</span>.<span class="token number">2</span>.el7.x86_64

kernel<span class="token number">-3.10</span>.<span class="token number">0</span><span class="token number">-514.2</span>.<span class="token number">2</span>.el7.x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启用新的内核，启用前查看grub2启动项</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>sudo egrep ^menuentry /etc/grub2.cfg | cut -f <span class="token number">2</span> -d \\&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>会有类似下面的输出</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>CentOS Linux <span class="token number">7</span> Rescue a0cbf86a6ef1416a8812657bb4f2b860 (<span class="token number">4.9</span>.<span class="token number">0</span><span class="token number">-1</span>.el7.elrepo.x86_64)

CentOS Linux (<span class="token number">4.9</span>.<span class="token number">0</span><span class="token number">-1</span>.el7.elrepo.x86_64) <span class="token number">7</span> (Core)

CentOS Linux (<span class="token number">3.10</span>.<span class="token number">0</span><span class="token number">-514.2</span>.<span class="token number">2</span>.el7.x86_64) <span class="token number">7</span> (Core)

CentOS Linux (<span class="token number">3.10</span>.<span class="token number">0</span><span class="token number">-514</span>.el7.x86_64) <span class="token number">7</span> (Core)

CentOS Linux (<span class="token number">0</span>-rescue-bf94f46c6bd04792a6a42c91bae645f7) <span class="token number">7</span> (Core)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>从上往下，从0开始往下数，我们要启用的内核位置是1，于是执行</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>sudo grub2-set-default <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>重启系统</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>reboot
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>重启后查看系统内核</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>uname -r
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>会有类似下面的输出</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token number">4.9</span>.<span class="token number">0</span><span class="token number">-1</span>.el7.elrepo.x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h2 id="步骤二-启用bbr" tabindex="-1"><a class="header-anchor" href="#步骤二-启用bbr" aria-hidden="true">#</a> 步骤二：启用BBR</h2><ol><li><p>修改<code>sysctl</code> 配置已启用BBR</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>echo &#39;net.core.default_qdisc=fq&#39; | sudo tee -a /etc/sysctl.conf

echo &#39;net.ipv4.tcp_congestion_control=bbr&#39; | sudo tee -a /etc/sysctl.conf

sudo sysctl -p
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>验证是否已经启用了BBR</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>sudo sysctl net.ipv4.tcp_available_congestion_control
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>会输出类似下面的内容</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>net.ipv4.tcp_available_congestion_control = bbr cubic reno
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>进一步验证</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>sudo sysctl -n net.ipv4.tcp_congestion_control
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>应该输出</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>bbr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>最后检查内核模块是否已经加载</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>lsmod | grep bbr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>会输出类似下面的内容</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>tcp_bbr                <span class="token number">16384</span>  <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h2 id="步骤三" tabindex="-1"><a class="header-anchor" href="#步骤三" aria-hidden="true">#</a> 步骤三</h2><p>没有了，享用BBR吧</p><br><h2 id="系统推荐" tabindex="-1"><a class="header-anchor" href="#系统推荐" aria-hidden="true">#</a> 系统推荐</h2>`,11),p=e("p",null,[e("br"),e("br"),e("br"),e("br"),e("br"),e("br")],-1),m=e("hr",null,null,-1),b=e("hr",null,null,-1),v=e("ul",null,[e("li",null,[e("strong",null,"随机毒鸡汤"),n("：经常废寝，从不忘食。 "),e("br"),e("br"),e("img",{src:"https://images.pexels.com/photos/31756436/pexels-photo-31756436.jpeg?auto=compress&cs=tinysrgb&h=650&w=940",alt:"Glass shot filled with coffee grounds on a brown mat, creating a cozy coffee shop vibe.",loading:"lazy"})])],-1);function g(E,h){const s=c("RouterLink");return r(),d("div",null,[u,e("ul",null,[e("li",null,[a(s,{to:"/software/unclassified/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F.html"},{default:l(()=>[n("记一次内存泄漏")]),_:1})]),e("li",null,[a(s,{to:"/other/%E6%9D%A5%E4%B8%AAJVM%E5%86%B7%E7%9F%A5%E8%AF%86.html"},{default:l(()=>[n("来个JVM冷知识")]),_:1})]),e("li",null,[a(s,{to:"/other/Nacos-Spring%20Gateway-Spring%20boot%E6%97%A0%E6%84%9F%E5%8F%91%E5%B8%83.html"},{default:l(()=>[n("Nacos-Spring Gateway-Spring boot无感发布")]),_:1})]),e("li",null,[a(s,{to:"/software/unclassified/%E7%BA%BF%E4%B8%8AFullGC%E9%A2%91%E7%B9%81%E7%9A%84%E6%8E%92%E6%9F%A5.html"},{default:l(()=>[n("线上FullGC频繁的排查")]),_:1})]),e("li",null,[a(s,{to:"/other/%E8%A1%8C%E8%BD%AC%E5%88%97%E4%B8%8D%E5%86%8D%E5%A4%8D%E6%9D%82%EF%BC%9ASQL%E9%AB%98%E6%89%8B%E9%83%BD%E5%9C%A8%E7%94%A8%E7%9A%84%E6%8A%80%E5%B7%A7%E6%8F%AD%E7%A7%98.html"},{default:l(()=>[n("行转列不再复杂：SQL高手都在用的技巧揭秘")]),_:1})]),e("li",null,[a(s,{to:"/software/java-basic/%E4%B8%8D%E9%87%8D%E5%90%AF%20JVM%EF%BC%8C%E5%A6%82%E4%BD%95%E6%9B%BF%E6%8D%A2%E6%8E%89%E5%B7%B2%E7%BB%8F%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%B1%BB%EF%BC%9F.html"},{default:l(()=>[n("不重启 JVM，如何替换掉已经加载的类？")]),_:1})]),e("li",null,[a(s,{to:"/other/PGSQL%E7%9A%84json%E5%92%8C%20jsonb%20%E8%AF%BB%E5%86%99%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html"},{default:l(()=>[n("PGSQL的json和 jsonb 读写性能测试")]),_:1})]),e("li",null,[a(s,{to:"/other/vuepress/vuepress-theme-hope%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97.html"},{default:l(()=>[n("vuepress-theme-hope使用心得")]),_:1})]),e("li",null,[a(s,{to:"/other/Lombok%E7%9A%84Accessors%E5%AF%BC%E8%87%B4EasyExcel%E8%AF%BB%E5%8F%96%E5%A4%B1%E8%B4%A5.html"},{default:l(()=>[n("Lombok的Accessors导致EasyExcel读取失败")]),_:1})]),e("li",null,[a(s,{to:"/software/middleware/mysql/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1Seata.html"},{default:l(()=>[n("分布式事务Seata")]),_:1})]),e("li",null,[a(s,{to:"/software/unclassified/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF.html"},{default:l(()=>[n("前后端常用技术")]),_:1})]),e("li",null,[a(s,{to:"/software/raft/sofajraft.html"},{default:l(()=>[n("sofajraft")]),_:1})])]),p,m,b,v])}const k=i(t,[["render",g],["__file","如何安装Google BBR.html.vue"]]);export{k as default};
