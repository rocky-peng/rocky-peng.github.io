<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="canonical" href="https://justsoso.fun/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html"><meta property="og:url" content="https://justsoso.fun/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html"><meta property="og:site_name" content="技术加油站"><meta property="og:title" content="Redis笔记"><meta property="og:description" content="什么redis那么快 基于内存，内存的访问速度是磁盘的上千倍； 基于 Reactor 模式设计开发了一套高效的事件处理模型，主要是单线程事件循环和 IO 多路复用（Redis 线程模式后面会详细介绍到）； 内置了多种优化过后的数据结构实现，性能非常高。 比如字符串并没有采用c原生字符串结构，而是采用了名为SDS的简单动态字符串结构，获取字符串长度的时间复杂度为O(1)，而c语言里的字符串获取字符串长度需要O(n)"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-04-17T12:26:19.000Z"><meta property="article:published_time" content="2022-08-05T00:00:00.000Z"><meta property="article:modified_time" content="2025-04-17T12:26:19.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redis笔记","image":[""],"datePublished":"2022-08-05T00:00:00.000Z","dateModified":"2025-04-17T12:26:19.000Z","author":[]}</script><meta name="referrer" content="no-referrer-when-downgrade"><meta name="google-adsense-account" content="ca-pub-6065963683065405"><script async crossOrigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6065963683065405"></script><script async crossOrigin="anonymous" src="//cdn.justdopay.top/scripts/busuanzi.pure.mini.js"></script><title>Redis笔记 | 技术加油站</title><meta name="description" content="什么redis那么快 基于内存，内存的访问速度是磁盘的上千倍； 基于 Reactor 模式设计开发了一套高效的事件处理模型，主要是单线程事件循环和 IO 多路复用（Redis 线程模式后面会详细介绍到）； 内置了多种优化过后的数据结构实现，性能非常高。 比如字符串并没有采用c原生字符串结构，而是采用了名为SDS的简单动态字符串结构，获取字符串长度的时间复杂度为O(1)，而c语言里的字符串获取字符串长度需要O(n)">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-6384e25f.css" as="style"><link rel="stylesheet" href="/assets/style-6384e25f.css">
    <link rel="modulepreload" href="/assets/app-48a5794b.js"><link rel="modulepreload" href="/assets/framework-b3a0f150.js"><link rel="modulepreload" href="/assets/Redis笔记.html-fac84cce.js"><link rel="modulepreload" href="/assets/Redis笔记.html-ff890994.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="技术加油站"><!----><span class="site-name hide-in-pad">技术加油站</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/software/" class="nav-link active" aria-label="Java技术栈"><FontIcon icon="discover"></FontIcon>Java技术栈<!----></a></div><div class="nav-item hide-in-mobile"><a href="/other/" class="nav-link" aria-label="其他"><FontIcon icon="discover"></FontIcon>其他<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/rocky-peng/rocky-peng.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">Docker</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">JAVA基础</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">JVM相关</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">Linux</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">Maccms</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">Raft</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">Shodowsocks</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">Spring</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><FontIcon></FontIcon><span class="title">中间件</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">ElasticSearch</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">MQ</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">MySQL</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><FontIcon></FontIcon><span class="title">Redis</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Redis笔记"><FontIcon></FontIcon>Redis笔记<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#什么redis那么快" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="什么redis那么快"><FontIcon></FontIcon>什么redis那么快<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis与-memcached的区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis与 memcached的区别"><FontIcon></FontIcon>redis与 memcached的区别<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#_5中常见数据结构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5中常见数据结构"><FontIcon></FontIcon>5中常见数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#_3中不常用数据结构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3中不常用数据结构"><FontIcon></FontIcon>3中不常用数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#string与hash" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="string与hash"><FontIcon></FontIcon>string与hash<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis的线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis的线程"><FontIcon></FontIcon>redis的线程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis刚开始为啥采用单线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis刚开始为啥采用单线程？"><FontIcon></FontIcon>redis刚开始为啥采用单线程？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis6-0为何又引入了多线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis6.0为何又引入了多线程"><FontIcon></FontIcon>redis6.0为何又引入了多线程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis的线程模型" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis的线程模型"><FontIcon></FontIcon>redis的线程模型<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#为啥要设置过期时间" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="为啥要设置过期时间"><FontIcon></FontIcon>为啥要设置过期时间<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis是如何判断某个key是否过期的" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis是如何判断某个key是否过期的？"><FontIcon></FontIcon>redis是如何判断某个key是否过期的？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#如何删除过期数据的" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="如何删除过期数据的？"><FontIcon></FontIcon>如何删除过期数据的？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis内存淘汰策略" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Redis内存淘汰策略"><FontIcon></FontIcon>Redis内存淘汰策略<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#持久化机制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="持久化机制"><FontIcon></FontIcon>持久化机制<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#aof重写" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="aof重写"><FontIcon></FontIcon>aof重写<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#混合持久化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="混合持久化"><FontIcon></FontIcon>混合持久化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis事务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis事务"><FontIcon></FontIcon>redis事务<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis优化技巧-使用技巧" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis优化技巧（使用技巧）"><FontIcon></FontIcon>redis优化技巧（使用技巧）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#缓存穿透" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="缓存穿透"><FontIcon></FontIcon>缓存穿透<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#缓存雪崩" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="缓存雪崩"><FontIcon></FontIcon>缓存雪崩<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#缓存和数据库一致性" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="缓存和数据库一致性"><FontIcon></FontIcon>缓存和数据库一致性<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#允许非严格一致性" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="允许非严格一致性"><FontIcon></FontIcon>允许非严格一致性<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#严格一致性" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="严格一致性"><FontIcon></FontIcon>严格一致性<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis-高可用方案" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis 高可用方案"><FontIcon></FontIcon>redis 高可用方案<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#保证高可用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="保证高可用"><FontIcon></FontIcon>保证高可用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis分布式锁" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis分布式锁"><FontIcon></FontIcon>redis分布式锁<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis限流器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="redis限流器"><FontIcon></FontIcon>redis限流器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#一致性hash" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="一致性hash"><FontIcon></FontIcon>一致性hash<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#限流算法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="限流算法"><FontIcon></FontIcon>限流算法<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#漏桶与令牌桶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="漏桶与令牌桶"><FontIcon></FontIcon>漏桶与令牌桶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#系统推荐" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="系统推荐"><FontIcon></FontIcon>系统推荐<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">八股文</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">操作系统</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><FontIcon></FontIcon><span class="title">未分类的</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><FontIcon></FontIcon>Redis笔记</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://justsoso.fun" target="_blank" rel="noopener noreferrer">Rocky</a></span><span property="author" content="Rocky"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-08-05T00:00:00.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 18 分钟</span><meta property="timeRequired" content="PT18M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#什么redis那么快" class="router-link-active router-link-exact-active toc-link level2">什么redis那么快</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis与-memcached的区别" class="router-link-active router-link-exact-active toc-link level2">redis与 memcached的区别</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#_5中常见数据结构" class="router-link-active router-link-exact-active toc-link level2">5中常见数据结构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#_3中不常用数据结构" class="router-link-active router-link-exact-active toc-link level2">3中不常用数据结构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#string与hash" class="router-link-active router-link-exact-active toc-link level2">string与hash</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis的线程" class="router-link-active router-link-exact-active toc-link level2">redis的线程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis刚开始为啥采用单线程" class="router-link-active router-link-exact-active toc-link level2">redis刚开始为啥采用单线程？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis6-0为何又引入了多线程" class="router-link-active router-link-exact-active toc-link level2">redis6.0为何又引入了多线程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis的线程模型" class="router-link-active router-link-exact-active toc-link level2">redis的线程模型</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#为啥要设置过期时间" class="router-link-active router-link-exact-active toc-link level2">为啥要设置过期时间</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis是如何判断某个key是否过期的" class="router-link-active router-link-exact-active toc-link level2">redis是如何判断某个key是否过期的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#如何删除过期数据的" class="router-link-active router-link-exact-active toc-link level2">如何删除过期数据的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis内存淘汰策略" class="router-link-active router-link-exact-active toc-link level2">Redis内存淘汰策略</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#持久化机制" class="router-link-active router-link-exact-active toc-link level2">持久化机制</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#aof重写" class="router-link-active router-link-exact-active toc-link level2">aof重写</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#混合持久化" class="router-link-active router-link-exact-active toc-link level2">混合持久化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis事务" class="router-link-active router-link-exact-active toc-link level2">redis事务</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis优化技巧-使用技巧" class="router-link-active router-link-exact-active toc-link level2">redis优化技巧（使用技巧）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#缓存穿透" class="router-link-active router-link-exact-active toc-link level2">缓存穿透</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#缓存雪崩" class="router-link-active router-link-exact-active toc-link level2">缓存雪崩</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#缓存和数据库一致性" class="router-link-active router-link-exact-active toc-link level2">缓存和数据库一致性</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#允许非严格一致性" class="router-link-active router-link-exact-active toc-link level3">允许非严格一致性</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#严格一致性" class="router-link-active router-link-exact-active toc-link level3">严格一致性</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis-高可用方案" class="router-link-active router-link-exact-active toc-link level2">redis 高可用方案</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#保证高可用" class="router-link-active router-link-exact-active toc-link level2">保证高可用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis分布式锁" class="router-link-active router-link-exact-active toc-link level2">redis分布式锁</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#redis限流器" class="router-link-active router-link-exact-active toc-link level2">redis限流器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#一致性hash" class="router-link-active router-link-exact-active toc-link level2">一致性hash</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#限流算法" class="router-link-active router-link-exact-active toc-link level2">限流算法</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#漏桶与令牌桶" class="router-link-active router-link-exact-active toc-link level3">漏桶与令牌桶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/software/middleware/redis/Redis%E7%AC%94%E8%AE%B0.html#系统推荐" class="router-link-active router-link-exact-active toc-link level2">系统推荐</a></li><!----><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="什么redis那么快" tabindex="-1"><a class="header-anchor" href="#什么redis那么快" aria-hidden="true">#</a> 什么redis那么快</h2><ol><li>基于内存，内存的访问速度是磁盘的上千倍；</li><li>基于 Reactor 模式设计开发了一套高效的事件处理模型，主要是单线程事件循环和 IO 多路复用（Redis 线程模式后面会详细介绍到）；</li><li>内置了多种优化过后的数据结构实现，性能非常高。</li></ol><blockquote><p>比如字符串并没有采用c原生字符串结构，而是采用了名为SDS的简单动态字符串结构，获取字符串长度的时间复杂度为O(1)，而c语言里的字符串获取字符串长度需要O(n)</p></blockquote><figure><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-13/513534661325800.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="redis与-memcached的区别" tabindex="-1"><a class="header-anchor" href="#redis与-memcached的区别" aria-hidden="true">#</a> redis与 memcached的区别</h2><h2 id="_5中常见数据结构" tabindex="-1"><a class="header-anchor" href="#_5中常见数据结构" aria-hidden="true">#</a> 5中常见数据结构</h2><ol><li>string</li></ol><p>redis中的string并没有采用c语言里的字符串，而是采用了一种名为SDS(simple dynamic string)简单动态字符串的结构。</p><p>获取字符串长度的时候，c语言里的字符串需要O(n)的时间复杂度，而sds只需要O(1)</p><ol start="2"><li>list</li></ol><p>底层的数据结构是一个双向链表，可以理解为是java里的LinkedList</p><ol start="3"><li>hash</li></ol><p>底层数据结构就是hash表嘛，可以理解为java里的hashmap，也是数组+链表</p><ol start="4"><li>set</li></ol><p>无序集合，可以理解为java里的HashSet</p><ol start="5"><li>zset(sorted set)</li></ol><p>相比set而言，增加了一个权重参数score，可以按照score进行排序，有点像java里的treeset</p><p>实际底层采用的数据结构是 <strong>跳表(skip table)</strong></p><figure><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-13/517837304615700.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>每两个节点向上抽取一个到上级构成索引，最终形成多级索引，时间复杂度为O(logn)</p><h2 id="_3中不常用数据结构" tabindex="-1"><a class="header-anchor" href="#_3中不常用数据结构" aria-hidden="true">#</a> 3中不常用数据结构</h2><ol><li>bitmap</li></ol><p>就是bit数组</p><ol start="2"><li>HyperLogLog</li></ol><p>不懂，好像是拿来计数的</p><ol start="3"><li>geo</li></ol><p>基于sorted set(zet)实现，将经纬度通过geohash算法转换为一个数字作为zset里的score，所以可以使用zset的相关命令</p><h2 id="string与hash" tabindex="-1"><a class="header-anchor" href="#string与hash" aria-hidden="true">#</a> string与hash</h2><p>这两个怎么选</p><ol><li>存储相同数据情况下，string比hash更省空间</li><li>hash可以对单个key进行各种操作，但string不行，所以这种情况下，hash需要传递的数据量更少，性能更高</li><li>如果对key需要频繁的单独更新，建议选择hash，其他情况可以选择string</li></ol><p>比如购物车的场景，建议采用hash，因为可能频繁的更改商品数量等属性</p><h2 id="redis的线程" tabindex="-1"><a class="header-anchor" href="#redis的线程" aria-hidden="true">#</a> redis的线程</h2><ol><li><p>最开始采用的是reactor的单线程模型，采用的网络io模型是多路复用</p></li><li><p>redis4.0版本为了处理一些大键值的删除操作，引入了多线程达到异步的效果 <img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-13/521888097572300.png" alt="" loading="lazy"></p></li><li><p>redis6.0版本在网络io方面也加入了多线程，来提高网络io的性能，采用的是reactor多线程模型（注意：对命令的执行还是单线程穿行执行）</p></li></ol><h2 id="redis刚开始为啥采用单线程" tabindex="-1"><a class="header-anchor" href="#redis刚开始为啥采用单线程" aria-hidden="true">#</a> redis刚开始为啥采用单线程？</h2><ol><li>单线程更加容易编程，方便维护</li><li>性能瓶颈不在是否采用cpu，而是在于内存和网络</li><li>引入多线程后编码相对复杂，并且还有引入新问题，比如线程的上下文切换等开销</li></ol><h2 id="redis6-0为何又引入了多线程" tabindex="-1"><a class="header-anchor" href="#redis6-0为何又引入了多线程" aria-hidden="true">#</a> redis6.0为何又引入了多线程</h2><p>其实不是在redis6.0才引入多线程，redis在4.0版本的时候就已经引入了多线程，只不过引入多线程的目的是为了针对一些大键值对的删除操作，因为这样的一些操作相对比较耗时，所以为了不影响其他任务，引入了多线程。</p><p>而redis6.0中引入多线程的目的在于进一步提高网络io的读写性能，比如数据的编码、解码</p><p><em>需要注意的是</em>：虽然redis6.0引入了多线程来提高网络io的读写性能，但在命令的执行上仍然是单线程顺序执行的</p><p>redis6.0的io多线程默认禁用的，通过参数 io-threads-do-reads 开启，再通过参数 io-threads 设置线程数，否则不生效</p><blockquote><p>官网建议4核的机器建议设置为2或3个线程，8核的建议设置为6个线程</p></blockquote><figure><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-14/580967195774400.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="redis的线程模型" tabindex="-1"><a class="header-anchor" href="#redis的线程模型" aria-hidden="true">#</a> redis的线程模型</h2><p>redis 内部使用文件事件处理器 file event handler，这个文件事件处理器是单线程的，所以 redis 才叫做单线程的模型。 它采用 IO 多路复用机制同时监听多个 socket，根据 socket 上的事件来选择对应的事件处理器进行处理。</p><p>文件事件处理器的结构包含 4 个部分：</p><ol><li>多个 socket</li><li>IO 多路复用程序</li><li>文件事件分派器</li><li>事件处理器（连接应答处理器、命令请求处理器、命令回复处理器）</li></ol><p>多个 socket 可能会并发产生不同的操作，每个操作对应不同的文件事件，但是 IO 多路复用程序会监听多个 socket，会将 socket 产生的事件放入队列中排队，事件分派器每次从队列中取出一个事件，把该事件交给对应的事件处理器进行处理。</p><figure><img src="https://cdn.justdopay.top/xiaoshujiang/1629082270476.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="为啥要设置过期时间" tabindex="-1"><a class="header-anchor" href="#为啥要设置过期时间" aria-hidden="true">#</a> 为啥要设置过期时间</h2><ol><li>内存是有限的，不设置的话可能很快就会导致内存使用完，最终崩溃</li><li>很多时候，存储的内容并不需要一直存在</li></ol><h2 id="redis是如何判断某个key是否过期的" tabindex="-1"><a class="header-anchor" href="#redis是如何判断某个key是否过期的" aria-hidden="true">#</a> redis是如何判断某个key是否过期的？</h2><p>redis内部有个过期字典，可以理解为hash表，这个字典的key指向了设置了过期时间的那个key，value就是这个key的过期时间，是一个unix的时间戳</p><p><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-13/524750547970699.png" alt="" loading="lazy"><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-13/524764299770800.png" alt="" loading="lazy"></p><h2 id="如何删除过期数据的" tabindex="-1"><a class="header-anchor" href="#如何删除过期数据的" aria-hidden="true">#</a> 如何删除过期数据的？</h2><p>分为两种删除策略：</p><ol><li>惰性删除 <ul><li>只有在对key进行某种操作的时候才会去检查是否过期，这样对cpu最友好，但有个问题就是可能会有一些过期的key并没有删除，仍驻留在内存中</li></ul></li><li>定期删除 <ul><li>redis会每隔一段时间抽取一批过期了的key进行删除</li><li>有了定期删除，但仍有可能会有一些过期key没有得到删除，或者内存不够用了，怎么办？ 那就依赖redis的内存淘汰策略</li></ul></li></ol><h2 id="redis内存淘汰策略" tabindex="-1"><a class="header-anchor" href="#redis内存淘汰策略" aria-hidden="true">#</a> <a href="https://github.com/Snailclimb/JavaGuide/blob/master/docs/database/Redis/Redis.md#redis-%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E6%9C%BA%E5%88%B6mysql%E9%87%8C%E6%9C%892000w%E6%95%B0%E6%8D%AEredis%E4%B8%AD%E5%8F%AA%E5%AD%9820w%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81redis%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E9%83%BD%E6%98%AF%E7%83%AD%E7%82%B9%E6%95%B0%E6%8D%AE" target="_blank" rel="noopener noreferrer">Redis内存淘汰策略<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><ul><li><p>volatile-lru：从已设置过期时间的数据集（server.db[i].expires）中挑选最近最少使用的数据淘汰</p></li><li><p>volatile-lfu：从已设置过期时间的数据集(server.db[i].expires)中挑选最不经常使用的数据淘汰</p></li><li><p>volatile-random：从已设置过期时间的数据集（server.db[i].expires）中任意选择数据淘汰</p></li><li><p>volatile-ttl：从已设置过期时间的数据集（server.db[i].expires）中挑选将要过期的数据淘汰</p></li><li><p>allkeys-lru：当内存不足以容纳新写入数据时，在键空间中，移除最近最少使用的key（这个是最常用的）</p></li><li><p>allkeys-lfu：当内存不足以容纳新写入数据时，在键空间中，移除最不经常使用的key</p></li><li><p>allkeys-random：从数据集（server.db[i].dict）中任意选择数据淘汰</p></li><li><p>no-eviction：禁止驱逐数据，也就是说当内存不足以容纳新写入数据时，新写入操作会报错。这个应该没人使用吧！</p></li></ul><p>lru：least recently used，最近最少使用的</p><p>lfu：least frequently used，最不经常使用的</p><h2 id="持久化机制" tabindex="-1"><a class="header-anchor" href="#持久化机制" aria-hidden="true">#</a> 持久化机制</h2><ol><li>rdb：快照 <ul><li>会创建某个时间点内存的快照，可用于在重启或崩溃时恢复数据。</li><li>创建快照是会影响正常使用吗？redis提供了save和bgsave两个命令，save命令会阻塞主进程，bgsave不会，默认是bgsave。</li><li>可在配置文件中配置多组save来创建快照</li></ul></li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#   In the example below the behaviour will be to save:
#   after 900 sec (15 min) if at least 1 key changed
#   after 300 sec (5 min) if at least 10 keys changed
#   after 60 sec if at least 10000 keys changed

save 900 1           #在900秒(15分钟)之后，如果至少有1个key发生变化，Redis就会自动触发bgsave命令创建快照。
save 300 10          #在300秒(5分钟)之后，如果至少有10个key发生变化，Redis就会自动触发bgsave命令创建快照。
save 60 10000        #在60秒(1分钟)之后，如果至少有10000个key发生变化，Redis就会自动触发bgsave命令创建快照。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>aof(append only file) <ul><li>每次在执行更新操作的时候，都会把命令记录到aof缓冲中（<strong>主线程在负责写</strong>），然后通过appendsync配置来决定何时把缓冲中的内容落盘</li><li>相对rdb来说，因为记录的是命令流水，aof文件通常会比rdb文件大很多</li><li>appendsync有三个参数（<strong>同步动作是由另外的线程负责</strong>）： <ol><li>always: 每次执行更改操作都会进行落盘，这种方式可以保证不会丢失命令，但影响性能</li><li>everysec: 每秒落盘一次，这种方式可能丢失命令，但对性能影响不大，算是1和3的居中方案</li><li>no: redis程序不负责落盘，由操作系统来决定何时落盘，这种方式也可能丢失命令</li></ol></li></ul></li></ol><h2 id="aof重写" tabindex="-1"><a class="header-anchor" href="#aof重写" aria-hidden="true">#</a> aof重写</h2><p>大概意思就是，由于aof记录的是命令流水，所以时间久了aof文件可能异常的大，通过aof重写能够缩写文件大小。 大致原理就是比如之前的aof有100条set命令，最终只保留一条，具体细节不知道</p><h2 id="混合持久化" tabindex="-1"><a class="header-anchor" href="#混合持久化" aria-hidden="true">#</a> 混合持久化</h2><p>redis4.0开始提供了混合持久化，就是aof重写的时候会直接把rdb的内容写到aof文件的开头，这样做的好处就是结合了rdb和aof的优点，但可读性会变差</p><h2 id="redis事务" tabindex="-1"><a class="header-anchor" href="#redis事务" aria-hidden="true">#</a> redis事务</h2><p>相关四个命令：MULTI、EXEC、DISCARD、WATCH</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt; MULTI
OK
&gt; SET USER &quot;Guide哥&quot;
QUEUED
&gt; GET USER
QUEUED
&gt; EXEC
1) OK
2) &quot;Guide哥&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>DISCARD就是放弃执行，注意不是回滚，redis的事务不支持回滚</p><p>redis的事务是把需要执行的命令放入一个队列中，当调用exec命令时候，则依次执行队列中的命令</p><p>WATCH: 在通过exec执行某个事务的时候，如果事务里的某个被watch命令监视的key被修改，那么整个事务都不会执行</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt; WATCH USER
OK
&gt; MULTI
&gt; SET USER &quot;Guide哥&quot;
OK
&gt; GET USER
Guide哥
&gt; EXEC
ERR EXEC without MULTI
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>事务对acid四个特性的支持： A: redis的事务不支持回滚，所以不支持A C: 不支持回滚，那当然不支持一致性 I: 由于命令的执行是单线程执行，所以不存在多个事务同时执行的情况，所以可以说支持隔离性吧 D: 有持久化的方案，可以说算支持吧</p><p><strong>总结</strong>：</p><ol><li>实际工作很少使用，不建议使用</li><li>redis的lua脚本本质也不支持原子性，如果lua脚本中途执行错误，之前执行了的命令是不会撤销的，出错之后的命令不会继续执行</li></ol><h2 id="redis优化技巧-使用技巧" tabindex="-1"><a class="header-anchor" href="#redis优化技巧-使用技巧" aria-hidden="true">#</a> redis优化技巧（使用技巧）</h2><ol><li>能设置过期时间都尽量设置一下，避免内存快速消耗，设置引发更严重的后果</li><li>在存放value的时候，value尽量不要太大</li><li>key字符串也尽量精简</li></ol><h2 id="缓存穿透" tabindex="-1"><a class="header-anchor" href="#缓存穿透" aria-hidden="true">#</a> 缓存穿透</h2><p>分两种情况：</p><ol><li>请求了大量数据库中不存在的key，导致大量请求落到数据库身上。</li><li>请求了打了数据库中存在的key，但是此时这个key刚好过期或者其他原因导致缓存中没有数据，最终大量请求落在数据库身上。</li></ol><p>第一种情况主要有两个方案：</p><ol><li>缓存不存在的key</li><li>布隆过滤器 具体可以参考： <a href="https://snailclimb.gitee.io/javaguide/#/docs/database/Redis/Redis?id=%e7%bc%93%e5%ad%98%e9%9b%aa%e5%b4%a9%e5%92%8c%e7%bc%93%e5%ad%98%e7%a9%bf%e9%80%8f%e9%97%ae%e9%a2%98%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88" target="_blank" rel="noopener noreferrer">缓存穿透<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol><p><strong>布隆过滤器说某个元素存在，小概率会误判。布隆过滤器说某个元素不在，那么这个元素一定不在。</strong></p><p>第二种情况的解决方案：</p><ul><li>分布式锁.</li></ul><p>具体如下：<br> 大量请求穿透缓存要去读数据库的时候，先上一个分布式锁，如果加锁不成功，则循环间隔时间读取缓存。 <br> 这个时候只有一个加锁成功，加锁成功这个请求读数据并更新缓存。</p><p>上面的做法可以进一步优化：<strong>本地锁和分布式锁配合使用</strong>。<br> 假设两个jvm实例，现在又1000个请求都是请求同一个数据，分布落在两个jvm实例上，分别500个请求，如果在两个jvm实例上使用分布式锁，那么就会有1000个请求几乎同时 发起分布式锁。这其实没有必要。可以先在本地使用本地锁，这个每个jvm实例上顶多有1个请求拿到锁，然后在请求分布式锁，这样大大减小了分布式锁的请求量 也减少了网络传输量</p><ul><li>不同的key设置不同的过期时间，避免同时失效</li></ul><h2 id="缓存雪崩" tabindex="-1"><a class="header-anchor" href="#缓存雪崩" aria-hidden="true">#</a> 缓存雪崩</h2><p>个人觉得缓存雪崩没有一个明确的定义，总的来说就是由于某些原因导致缓存不可用，这样大量请求打到后端db，引发一系列问题出来</p><p>从这个层面来说，缓存穿透也算缓存雪崩</p><p>还有就是比如集群下的redis，可能由于采用了不恰当的分片算法，但某个节点不可用时，导致整个redis集群不可用，最终请求到达db</p><h2 id="缓存和数据库一致性" tabindex="-1"><a class="header-anchor" href="#缓存和数据库一致性" aria-hidden="true">#</a> 缓存和数据库一致性</h2><p>一般情况下我们都是这样使用缓存的：</p><p>先读缓存，缓存没有的话，就读数据库，然后取出数据后放入缓存，同时返回响应。</p><p>这种方式很明显会存在缓存和数据库的数据不一致的情况。</p><h3 id="允许非严格一致性" tabindex="-1"><a class="header-anchor" href="#允许非严格一致性" aria-hidden="true">#</a> 允许非严格一致性</h3><p>下面的方案在读数据的时候，流程都是一样的：先读缓存，缓存没有的话，就读数据库，然后取出数据后放入缓存</p><p>区别在于更新数据的时候：</p><ol><li><p>先更新数据库，后删除缓存（不是更新，这种称之为 Cache Aside Pattern）</p><blockquote><p>如果删除缓存失败，增加重试机制，也就是当网络可用或缓存服务可用的时候再次删除</p></blockquote></li><li><p>先删缓存在更新数据库</p></li><li><p>先更新数据库，后更新缓存（是更新，不是删除）</p></li></ol><p>上面三种方案各有优劣，没有谁一定比谁好，具体要看业务情况选择</p><h3 id="严格一致性" tabindex="-1"><a class="header-anchor" href="#严格一致性" aria-hidden="true">#</a> 严格一致性</h3><p>就是读写请求要串行化，非常影响性能</p><p>读数据的时候，如果次数没有请求要更新缓存，则尝试走缓存；如果发现有请求要更新缓存，则等待那个请求完成再走缓存。</p><p>走缓存的逻辑：</p><p>如果缓存有数据，则直接返回；如果没有，则先标识自己要更新缓存，如果标识成功，则读数据库并更新缓存。</p><p>如果标识不成功，则等待标识成功的请求完成再读缓存。</p><p>可以参考：<a href="https://github.com/doocs/advanced-java/blob/master/docs/high-concurrency/redis-consistence.md" target="_blank" rel="noopener noreferrer">https://github.com/doocs/advanced-java/blob/master/docs/high-concurrency/redis-consistence.md<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>这个网址作为一个参考，个人觉得描述有点繁琐。</p><ul><li><p>Redis键过期策略</p><ul><li><p>定期删除</p></li><li><p>惰性删除</p></li></ul></li></ul><h2 id="redis-高可用方案" tabindex="-1"><a class="header-anchor" href="#redis-高可用方案" aria-hidden="true">#</a> redis 高可用方案</h2><ol><li>codis</li><li>自带的cluster方案</li><li>Twemproxy <blockquote><p>twitter的</p></blockquote></li></ol><figure><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-14/598595719416100.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="保证高可用" tabindex="-1"><a class="header-anchor" href="#保证高可用" aria-hidden="true">#</a> 保证高可用</h2><ol><li>首先尽量保证redis集群的本身的高可用【采用合适的分片算法、还可以做master/slave这些，以及合适的持久化方案】</li><li>万一还是挂了，启用限流，保证后端的db不会挂掉，同时尽快恢复redis集群</li></ol><h2 id="redis分布式锁" tabindex="-1"><a class="header-anchor" href="#redis分布式锁" aria-hidden="true">#</a> redis分布式锁</h2><ol><li>redlock: 是一种算法，全名叫做 Redis Distributed Lock;</li></ol><p>大概意思有点想raft算法，就是要绝大多数节点加锁成功才算加锁成功</p><ol start="2"><li>redission：封装了java版本的redlock算法，也支持单个redis节点</li></ol><p>万一服务挂了，后台有个线程会一直给当前锁续期，默认的ttl是30s，看门狗会每隔10秒就续期一次 <img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-14/598116352771500.png" alt="" loading="lazy"></p><h2 id="redis限流器" tabindex="-1"><a class="header-anchor" href="#redis限流器" aria-hidden="true">#</a> redis限流器</h2><p>s</p><h2 id="一致性hash" tabindex="-1"><a class="header-anchor" href="#一致性hash" aria-hidden="true">#</a> 一致性hash</h2><figure><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-14/603424498383900.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>采用 FNV-Hash 算法，这种算法的特点是：能快速hash大量数据并保持较小的冲突率。</p><p>它的高度分散使它适用于hash一些非常相近的字符串，比如URL，hostname，文件名，text，IP地址等。</p><figure><img src="https://cdn.justdopay.top/pasteimageintomarkdown/2022-09-14/603469121813500.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="限流算法" tabindex="-1"><a class="header-anchor" href="#限流算法" aria-hidden="true">#</a> 限流算法</h2><ol><li>固定窗口（计数法）</li><li>滑动窗口</li><li>漏桶 <blockquote><p>可以想象为java里的队列，队列的容量有限，队列满了则拒绝执行，请求进来先排队，然后系统从队列里取出请求进行处理 比如可以用一个aop实现，接收到请求后，信号量减一，初始信量化是1w，就相当于桶的容量，每处理完成一个请求，则加一（可以用redis中的加加减减实现）</p></blockquote></li><li>令牌桶 <blockquote><p>和漏桶有点像，具体aop的逻辑是： 接收到请求后，信号量减一，请求处理完成不加一，而是由另外一个线程已固定的速率增加信号量（这个地方用信号量可能不恰当，但可以理解为redis中的加加减减）</p></blockquote></li></ol><h3 id="漏桶与令牌桶" tabindex="-1"><a class="header-anchor" href="#漏桶与令牌桶" aria-hidden="true">#</a> 漏桶与令牌桶</h3><ol><li>漏桶是已固定的速率处理请求，至于请求进来的速度没有限制，只要桶还有容量，不过可以稍微修改下不以固定速率处理请求，而是能处理多块就多块</li><li>令牌桶是以固定的速率生产令牌，处理请求必须先获得令牌，令牌桶貌似可以理解为倒着的漏桶，漏桶是固定速率出水，令牌桶是固定速率进水</li><li>令牌桶是以恒定速率创建令牌，但是访问请求获取令牌的速率“不定”，反正有多少令牌发多少，令牌没了就干等。而漏桶是以“恒定”的速率处理请求，但是这些请求流入桶的速率是“不定”的。</li><li>漏桶的天然特性决定了漏桶后面的系统不会发生突发流量，这个既是优点又是缺点，优点就是后面的系统不会有突发流量，缺点就是一些</li></ol><p>上面的限流算法都是一个理论，具体实现可能和理论并不一致，也就是可能具体的实现既有漏桶的影子，也有令牌桶的影子。</p><p>扩展阅读：</p><ol><li><a href="https://blog.csdn.net/weixin_41846320/article/details/95941361" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_41846320/article/details/95941361<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.jianshu.com/p/88ff90519ab1" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/88ff90519ab1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li></li></ol><br><h2 id="系统推荐" tabindex="-1"><a class="header-anchor" href="#系统推荐" aria-hidden="true">#</a> 系统推荐</h2><ul><li><a href="/software/unclassified/Oh%20My%20ZSH.html" class="">Oh My ZSH</a></li><li><a href="/software/unclassified/MyBatis.html" class="">MyBatis</a></li><li><a href="/software/docker/Docker%E8%BF%9B%E8%A1%8C%E8%B5%84%E6%BA%90%E9%9A%94%E7%A6%BB.html" class="">Docker进行资源隔离</a></li><li><a href="/other/Nacos-Spring%20Gateway-Spring%20boot%E6%97%A0%E6%84%9F%E5%8F%91%E5%B8%83.html" class="">Nacos-Spring Gateway-Spring boot无感发布</a></li><li><a href="/other/JetBrains%20IDE%20%E5%85%A8%E7%A0%B4%E8%A7%A3.html" class="">JetBrains IDE 全破解</a></li><li><a href="/software/jvm/JDK%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7.html" class="">JDK命令行工具</a></li><li><a href="/other/Cornell%20Notes%20System.html" class="">Cornell Notes System</a></li><li><a href="/software/middleware/es/%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8Edocker%E7%9A%84elk%E5%B9%B3%E5%8F%B0%E6%9D%A5%E5%88%86%E6%9E%90java%E6%97%A5%E5%BF%97.html" class="">搭建基于docker的elk平台来分析java日志</a></li><li><a href="/software/middleware/mysql/MySQL%E7%B4%A2%E5%BC%95.html" class="">MySQL索引</a></li><li><a href="/software/unclassified/%E5%A4%9A%E5%8F%B0centos%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E6%96%87%E4%BB%B6%E4%BA%92%E7%9B%B8%E5%A4%87%E4%BB%BD.html" class="">多台centos服务器，文件互相备份</a></li><li><a href="/software/shodowsocks/ShadowsockServer%E9%85%8D%E7%BD%AE.html" class="">ShadowsockServer配置</a></li><li><a href="/other/SpringBoot%E6%9C%8D%E5%8A%A1%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E5%AE%8C%E6%88%90%E5%89%8D%E8%A2%AB%E6%8F%90%E5%89%8D%E6%B3%A8%E5%86%8C%E5%88%B0nacos.html" class="">SpringBoot服务在服务启动完成前被提前注册到nacos</a></li></ul><p><br><br><br><br><br><br></p><hr><hr><ul><li><strong>随机毒鸡汤</strong>：所有的焦虑不安，都源于你的实力，配不上你的野心。 <br><br><img src="https://images.pexels.com/photos/8969189/pexels-photo-8969189.jpeg?auto=compress&amp;cs=tinysrgb&amp;h=650&amp;w=940" alt="Monochrome portrait of a smiling man indoors in Kazakhstan." loading="lazy"></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/rocky-peng/rocky-peng.github.io/edit/main/src/software/middleware/redis/Redis笔记.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><!----></div></footer><!----><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="https://justsoso.fun" target="_blank">技术加油站</a>&nbsp;|&nbsp;<a href="/sitemap.xml" target="_blank">站点地图</a>&nbsp;|&nbsp;本站总访问量<span id="busuanzi_value_site_pv"></span>次&nbsp;|&nbsp;本文总访问量<span id="busuanzi_value_page_pv"></span>次&nbsp;|&nbsp;本站总访客数<span id="busuanzi_value_site_uv"></span>人<!-- <a href="https://beian.miit.gov.cn/" target="_blank">渝ICP备2022014544号-1</a> --><!--&nbsp;|&nbsp; <a href="http://leyongjituan.com">乐用集团</a>--></div><div class="copyright">Copyright © 2025 Rocky</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-48a5794b.js" defer></script>
  </body>
</html>
